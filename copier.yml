# Template configuration
_subdirectory: template
_templates_suffix: .j2

# Exclude patterns (files and folders that won't be copied)
_exclude:
    - 'template/helpers'
    - 'template/helpers/*.j2'
    - 'helpers'
    - 'helpers/*.j2'
    - '!template'
    - 'CLAUDE.md'

# Post-generation tasks
_tasks:
    - env
    # Check if pyenv is installed and set up Python version
    - 'if command -v pyenv >/dev/null 2>&1; then pyenv install --skip-existing {{ python_version }} && eval "$(pyenv init - sh)"; else echo "pyenv not found, skipping Python version setup"; fi'

    - cd {{ _copier_conf.dst_path }} && python --version

    # Set Python version with pyenv if available
    - 'cd {{ _copier_conf.dst_path }} && if command -v pyenv >/dev/null 2>&1; then echo {{ python_version }} > .python-version && pyenv local {{ python_version }}; else echo "pyenv not found, skipping .python-version setup"; fi'

    # Install uv if not already available
    - 'cd {{ _copier_conf.dst_path }} && if ! command -v uv >/dev/null 2>&1; then pip install uv; else echo "uv already installed"; fi'

    # Initialize git repository
    - 'cd {{ _copier_conf.dst_path }} && git init'

    # Create a lockfile and sync dependencies if uv is available
    - 'cd {{ _copier_conf.dst_path }} && if command -v uv >/dev/null 2>&1; then uv sync --all-extras --all-groups --no-binary; else echo "uv not available, skipping dependency sync"; fi'

    # Initialize pre-commit if available
    - 'cd {{ _copier_conf.dst_path }} && if command -v pre-commit >/dev/null 2>&1; then pre-commit install; fi'

    # Allow the envrc if direnv is available
    - 'cd {{ _copier_conf.dst_path }} && if command -v direnv >/dev/null 2>&1; then direnv allow; fi'

# questions
project_name:
    type: str
    help: What is your project's name?

module_name:
    type: str
    help: What is your Python module name?
    default: "{%- include 'template/helpers/module-default.j2' -%}"

package_name:
    type: str
    help: What is your Python package name?
    default: "{%- include 'template/helpers/package-name.j2' -%}"

python_version:
    type: str
    help: Select Python version to use with pyenv
    default: '3.11'

user_name:
    type: str
    default: "Scott Hyndman"

user_email:
    type: str
    default: "scotty.hyndman@gmail.com"

github_user:
    type: str
    default: "shyndman"

include_ci_workflow:
    type: bool
    default: true
    help: Include CI workflow with Ruff, Pyright, and pytest?

include_docker_workflow:
    type: bool
    default: false
    help: Include Docker build and publish workflow?

